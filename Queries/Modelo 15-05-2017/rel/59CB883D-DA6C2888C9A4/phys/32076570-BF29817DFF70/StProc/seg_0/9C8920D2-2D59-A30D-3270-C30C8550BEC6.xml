<?xml version = '1.0' encoding = 'UTF-8'?>
<StoredProcedureOraclev10g class="oracle.dbtools.crest.model.design.storage.oracle.v10g.StoredProcedureOraclev10g" name="INS_ARCHIVO" directorySegmentName="seg_0" id="9C8920D2-2D59-A30D-3270-C30C8550BEC6">
<sourceConnName>Desarrollo2</sourceConnName>
<sourceObjSchema>CONSULTOR3</sourceObjSchema>
<sourceObjName>INS_ARCHIVO</sourceObjName>
<createdBy>consultor3</createdBy>
<createdTime>2017-05-16 03:15:38 UTC</createdTime>
<ownerDesignName>Modelo 15-05-2017</ownerDesignName>
<owner>AE2292FC-43E2-FF51-8677-819EDD136431</owner>
<source>CREATE OR REPLACE PROCEDURE CONSULTOR3.INS_ARCHIVO (&lt;br/&gt;  VAR_ID_DET_VERSION IN NUMBER,&lt;br/&gt;  VAR_NOMB_ARCHIVO IN VARCHAR2, &lt;br/&gt;  VAR_TIPO_ARCHIVO IN VARCHAR2, &lt;br/&gt;  VAR_RUTA_ARCHIVO IN VARCHAR2, &lt;br/&gt;  VAR_ARCH_USR_REG IN VARCHAR2,&lt;br/&gt;  CUR_RPTA OUT SYS_REFCURSOR ) IS&lt;br/&gt;  ID_ARCHIVO_INS NUMBER;&lt;br/&gt;BEGIN&lt;br/&gt;&lt;br/&gt;    SAVEPOINT obtenerResultados;&lt;br/&gt;&lt;br/&gt;	INSERT INTO T_ARCHIVO (NOMB_ARCHIVO,TIPO_ARCHIVO,RUTA_ARCHIVO,ARCH_FEC_REG,ARCH_USR_REG)&lt;br/&gt;	VALUES&lt;br/&gt;	(VAR_NOMB_ARCHIVO,VAR_TIPO_ARCHIVO,VAR_RUTA_ARCHIVO,SYSDATE,VAR_ARCH_USR_REG)&lt;br/&gt;	RETURNING ID_ARCHIVO INTO ID_ARCHIVO_INS;&lt;br/&gt;&lt;br/&gt;	INSERT INTO T_DET_ARCHIVO(ID_DETALLE,ID_ARCHIVO)&lt;br/&gt;	VALUES&lt;br/&gt;	(VAR_ID_DET_VERSION,ID_ARCHIVO_INS);&lt;br/&gt;&lt;br/&gt;	OPEN CUR_RPTA FOR&lt;br/&gt;	SELECT&lt;br/&gt;       A.ID_ARCHIVO,&lt;br/&gt;	   A.NOMB_ARCHIVO,&lt;br/&gt;	   A.TIPO_ARCHIVO,&lt;br/&gt;	   A.RUTA_ARCHIVO,&lt;br/&gt;	   A.ARCH_FEC_REG,&lt;br/&gt;	   A.ARCH_USR_REG&lt;br/&gt;	FROM&lt;br/&gt;		T_ARCHIVO A &lt;br/&gt;	WHERE&lt;br/&gt;		A.ID_ARCHIVO=ID_ARCHIVO_INS;&lt;br/&gt;&lt;br/&gt;EXCEPTION &lt;br/&gt;        WHEN OTHERS THEN&lt;br/&gt;&lt;br/&gt;            ROLLBACK TO obtenerResultados;&lt;br/&gt;            RAISE;&lt;br/&gt;END;</source>
<body>CREATE OR REPLACE PROCEDURE CONSULTOR3.INS_ARCHIVO (&lt;br/&gt;  VAR_ID_DET_VERSION IN NUMBER,&lt;br/&gt;  VAR_NOMB_ARCHIVO IN VARCHAR2, &lt;br/&gt;  VAR_TIPO_ARCHIVO IN VARCHAR2, &lt;br/&gt;  VAR_RUTA_ARCHIVO IN VARCHAR2, &lt;br/&gt;  VAR_ARCH_USR_REG IN VARCHAR2,&lt;br/&gt;  CUR_RPTA OUT SYS_REFCURSOR ) IS&lt;br/&gt;  ID_ARCHIVO_INS NUMBER;&lt;br/&gt;BEGIN&lt;br/&gt;&lt;br/&gt;    SAVEPOINT obtenerResultados;&lt;br/&gt;&lt;br/&gt;	INSERT INTO T_ARCHIVO (NOMB_ARCHIVO,TIPO_ARCHIVO,RUTA_ARCHIVO,ARCH_FEC_REG,ARCH_USR_REG)&lt;br/&gt;	VALUES&lt;br/&gt;	(VAR_NOMB_ARCHIVO,VAR_TIPO_ARCHIVO,VAR_RUTA_ARCHIVO,SYSDATE,VAR_ARCH_USR_REG)&lt;br/&gt;	RETURNING ID_ARCHIVO INTO ID_ARCHIVO_INS;&lt;br/&gt;&lt;br/&gt;	INSERT INTO T_DET_ARCHIVO(ID_DETALLE,ID_ARCHIVO)&lt;br/&gt;	VALUES&lt;br/&gt;	(VAR_ID_DET_VERSION,ID_ARCHIVO_INS);&lt;br/&gt;&lt;br/&gt;	OPEN CUR_RPTA FOR&lt;br/&gt;	SELECT&lt;br/&gt;       A.ID_ARCHIVO,&lt;br/&gt;	   A.NOMB_ARCHIVO,&lt;br/&gt;	   A.TIPO_ARCHIVO,&lt;br/&gt;	   A.RUTA_ARCHIVO,&lt;br/&gt;	   A.ARCH_FEC_REG,&lt;br/&gt;	   A.ARCH_USR_REG&lt;br/&gt;	FROM&lt;br/&gt;		T_ARCHIVO A &lt;br/&gt;	WHERE&lt;br/&gt;		A.ID_ARCHIVO=ID_ARCHIVO_INS;&lt;br/&gt;&lt;br/&gt;EXCEPTION &lt;br/&gt;        WHEN OTHERS THEN&lt;br/&gt;&lt;br/&gt;            ROLLBACK TO obtenerResultados;&lt;br/&gt;            RAISE;&lt;br/&gt;END;</body>
</StoredProcedureOraclev10g>