<?xml version = '1.0' encoding = 'UTF-8'?>
<StoredProcedureOraclev10g class="oracle.dbtools.crest.model.design.storage.oracle.v10g.StoredProcedureOraclev10g" name="GET_VERSIONES" directorySegmentName="seg_0" id="1CF88D00-0A21-7364-82CE-82EE34009AE5">
<sourceConnName>Desarrollo2</sourceConnName>
<sourceObjSchema>CONSULTOR3</sourceObjSchema>
<sourceObjName>GET_VERSIONES</sourceObjName>
<createdBy>consultor3</createdBy>
<createdTime>2017-05-16 03:15:38 UTC</createdTime>
<ownerDesignName>Modelo 15-05-2017</ownerDesignName>
<owner>AE2292FC-43E2-FF51-8677-819EDD136431</owner>
<source>CREATE OR REPLACE PROCEDURE CONSULTOR3.GET_VERSIONES (&lt;br/&gt;VAR_ID_PRESUPUESTO_TIPO IN NUMBER, &lt;br/&gt;VAR_ID_AREA IN NUMBER,&lt;br/&gt;CUR_RPTA OUT sys_refcursor)IS&lt;br/&gt;BEGIN&lt;br/&gt;&lt;br/&gt;    SAVEPOINT obtenerResultados;&lt;br/&gt;&lt;br/&gt;    OPEN CUR_RPTA FOR&lt;br/&gt;    SELECT&lt;br/&gt;    A.id_version,&lt;br/&gt;    A.nro,&lt;br/&gt;    A.ID_DET_PRESUP,&lt;br/&gt;    A.id_area,&lt;br/&gt;    A.v_fecha_reg,&lt;br/&gt;    A.v_usuario_reg,&lt;br/&gt;    A.v_ult_modif_fec,&lt;br/&gt;    A.v_fecha_val_ini,&lt;br/&gt;    A.v_fecha_val_fin,&lt;br/&gt;    A.est_actual,&lt;br/&gt;    B.id_presupuesto,&lt;br/&gt;    B.id_tipo,&lt;br/&gt;    B.DET_P_fecha_reg,&lt;br/&gt;	B.DET_P_USR_REG,&lt;br/&gt;    B.DET_P_ult_modif_fec,&lt;br/&gt;    B.DET_P_modif_usr,&lt;br/&gt;    B.DET_P_fecha_val_ini,&lt;br/&gt;    B.DET_P_fecha_val_fin,&lt;br/&gt;    B.DET_P_est_actual&lt;br/&gt;    ,NVL(SUM(C.TOTAL_SOLIC),0) MONTO&lt;br/&gt;    FROM&lt;br/&gt;        t_version A&lt;br/&gt;        RIGHT JOIN T_DET_PRESUP B ON A.ID_DET_PRESUP = B.ID_DET_PRESUP &lt;br/&gt;        LEFT JOIN T_DET_VERSION C ON A.ID_VERSION= C.ID_VERSION&lt;br/&gt;        WHERE A.ID_DET_PRESUP = VAR_ID_PRESUPUESTO_TIPO AND ID_AREA=VAR_ID_AREA&lt;br/&gt;        GROUP BY &lt;br/&gt;    A.id_version,&lt;br/&gt;    A.nro,&lt;br/&gt;    A.ID_DET_PRESUP,&lt;br/&gt;    A.id_area,&lt;br/&gt;    A.v_fecha_reg,&lt;br/&gt;    A.v_usuario_reg,&lt;br/&gt;    A.v_ult_modif_fec,&lt;br/&gt;    A.v_fecha_val_ini,&lt;br/&gt;    A.v_fecha_val_fin,&lt;br/&gt;    A.est_actual,&lt;br/&gt;    B.id_presupuesto,&lt;br/&gt;    B.id_tipo,&lt;br/&gt;    B.DET_P_fecha_reg,&lt;br/&gt;	B.DET_P_USR_REG,&lt;br/&gt;    B.DET_P_ult_modif_fec,&lt;br/&gt;    B.DET_P_modif_usr,&lt;br/&gt;    B.DET_P_fecha_val_ini,&lt;br/&gt;    B.DET_P_fecha_val_fin,&lt;br/&gt;    B.DET_P_est_actual    &lt;br/&gt;    ORDER BY NRO DESC&lt;br/&gt;        ;&lt;br/&gt;&lt;br/&gt;&lt;br/&gt;EXCEPTION &lt;br/&gt;        WHEN OTHERS THEN&lt;br/&gt;&lt;br/&gt;            ROLLBACK TO obtenerResultados;&lt;br/&gt;            RAISE;&lt;br/&gt;END;</source>
<body>CREATE OR REPLACE PROCEDURE CONSULTOR3.GET_VERSIONES (&lt;br/&gt;VAR_ID_PRESUPUESTO_TIPO IN NUMBER, &lt;br/&gt;VAR_ID_AREA IN NUMBER,&lt;br/&gt;CUR_RPTA OUT sys_refcursor)IS&lt;br/&gt;BEGIN&lt;br/&gt;&lt;br/&gt;    SAVEPOINT obtenerResultados;&lt;br/&gt;&lt;br/&gt;    OPEN CUR_RPTA FOR&lt;br/&gt;    SELECT&lt;br/&gt;    A.id_version,&lt;br/&gt;    A.nro,&lt;br/&gt;    A.ID_DET_PRESUP,&lt;br/&gt;    A.id_area,&lt;br/&gt;    A.v_fecha_reg,&lt;br/&gt;    A.v_usuario_reg,&lt;br/&gt;    A.v_ult_modif_fec,&lt;br/&gt;    A.v_fecha_val_ini,&lt;br/&gt;    A.v_fecha_val_fin,&lt;br/&gt;    A.est_actual,&lt;br/&gt;    B.id_presupuesto,&lt;br/&gt;    B.id_tipo,&lt;br/&gt;    B.DET_P_fecha_reg,&lt;br/&gt;	B.DET_P_USR_REG,&lt;br/&gt;    B.DET_P_ult_modif_fec,&lt;br/&gt;    B.DET_P_modif_usr,&lt;br/&gt;    B.DET_P_fecha_val_ini,&lt;br/&gt;    B.DET_P_fecha_val_fin,&lt;br/&gt;    B.DET_P_est_actual&lt;br/&gt;    ,NVL(SUM(C.TOTAL_SOLIC),0) MONTO&lt;br/&gt;    FROM&lt;br/&gt;        t_version A&lt;br/&gt;        RIGHT JOIN T_DET_PRESUP B ON A.ID_DET_PRESUP = B.ID_DET_PRESUP &lt;br/&gt;        LEFT JOIN T_DET_VERSION C ON A.ID_VERSION= C.ID_VERSION&lt;br/&gt;        WHERE A.ID_DET_PRESUP = VAR_ID_PRESUPUESTO_TIPO AND ID_AREA=VAR_ID_AREA&lt;br/&gt;        GROUP BY &lt;br/&gt;    A.id_version,&lt;br/&gt;    A.nro,&lt;br/&gt;    A.ID_DET_PRESUP,&lt;br/&gt;    A.id_area,&lt;br/&gt;    A.v_fecha_reg,&lt;br/&gt;    A.v_usuario_reg,&lt;br/&gt;    A.v_ult_modif_fec,&lt;br/&gt;    A.v_fecha_val_ini,&lt;br/&gt;    A.v_fecha_val_fin,&lt;br/&gt;    A.est_actual,&lt;br/&gt;    B.id_presupuesto,&lt;br/&gt;    B.id_tipo,&lt;br/&gt;    B.DET_P_fecha_reg,&lt;br/&gt;	B.DET_P_USR_REG,&lt;br/&gt;    B.DET_P_ult_modif_fec,&lt;br/&gt;    B.DET_P_modif_usr,&lt;br/&gt;    B.DET_P_fecha_val_ini,&lt;br/&gt;    B.DET_P_fecha_val_fin,&lt;br/&gt;    B.DET_P_est_actual    &lt;br/&gt;    ORDER BY NRO DESC&lt;br/&gt;        ;&lt;br/&gt;&lt;br/&gt;&lt;br/&gt;EXCEPTION &lt;br/&gt;        WHEN OTHERS THEN&lt;br/&gt;&lt;br/&gt;            ROLLBACK TO obtenerResultados;&lt;br/&gt;            RAISE;&lt;br/&gt;END;</body>
</StoredProcedureOraclev10g>