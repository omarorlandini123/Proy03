<?xml version = '1.0' encoding = 'UTF-8'?>
<StoredProcedureOraclev10g class="oracle.dbtools.crest.model.design.storage.oracle.v10g.StoredProcedureOraclev10g" name="INS_PRESUP" directorySegmentName="seg_0" id="F56E7C5B-CCCE-6943-89C6-B49CE548D964">
<sourceConnName>Desarrollo2</sourceConnName>
<sourceObjSchema>CONSULTOR3</sourceObjSchema>
<sourceObjName>INS_PRESUP</sourceObjName>
<createdBy>consultor3</createdBy>
<createdTime>2017-05-16 03:15:38 UTC</createdTime>
<ownerDesignName>Modelo 15-05-2017</ownerDesignName>
<owner>AE2292FC-43E2-FF51-8677-819EDD136431</owner>
<source>CREATE OR REPLACE PROCEDURE CONSULTOR3.INS_PRESUP (&lt;br/&gt;  &quot;VAR_NOMBRE&quot; IN VARCHAR2, &lt;br/&gt;  &quot;VAR_ID_SEDE&quot; IN NUMBER, &lt;br/&gt;  &quot;VAR_USUARIO_REG&quot; IN VARCHAR2, &lt;br/&gt;  &quot;VAR_DESDE&quot; IN DATE, &lt;br/&gt;  &quot;VAR_HASTA&quot; IN DATE,&lt;br/&gt;  &quot;CUR_RPTA&quot; OUT SYS_REFCURSOR ) IS&lt;br/&gt;BEGIN&lt;br/&gt;&lt;br/&gt;    SAVEPOINT obtenerResultados;&lt;br/&gt;&lt;br/&gt;	INSERT INTO T_PRESUP (NOMB_PRESUP,ID_SEDE,FECHA_REG,USUARIO_REG,ULT_MODIF_FEC, ULT_MODIF_USER, FECHA_VAL_INI, FECHA_VAL_FIN,EST_ACTUAL)&lt;br/&gt;	VALUES&lt;br/&gt;	(VAR_NOMBRE,VAR_ID_SEDE,SYSDATE,VAR_USUARIO_REG,SYSDATE,VAR_USUARIO_REG,VAR_DESDE,VAR_HASTA,5);&lt;br/&gt;&lt;br/&gt;	OPEN CUR_RPTA FOR&lt;br/&gt;	SELECT&lt;br/&gt;        A.ID_PRESUPUESTO,&lt;br/&gt;        A.NOMB_PRESUP,&lt;br/&gt;        A.ID_SEDE,&lt;br/&gt;		B.NOMB_SEDE,&lt;br/&gt;        A.FECHA_REG,&lt;br/&gt;        A.USUARIO_REG,&lt;br/&gt;        A.ULT_MODIF_FEC,&lt;br/&gt;        A.ULT_MODIF_USER,&lt;br/&gt;        A.FECHA_VAL_INI,&lt;br/&gt;        A.FECHA_VAL_FIN,&lt;br/&gt;        A.EST_ACTUAL&lt;br/&gt;	FROM&lt;br/&gt;		T_PRESUP A &lt;br/&gt;		INNER JOIN T_SEDE B ON A.ID_SEDE=B.ID_SEDE&lt;br/&gt;	WHERE&lt;br/&gt;		A.FECHA_REG=(SELECT MAX(FECHA_REG) FROM T_PRESUP);&lt;br/&gt;&lt;br/&gt;EXCEPTION &lt;br/&gt;        WHEN OTHERS THEN&lt;br/&gt;&lt;br/&gt;            ROLLBACK TO obtenerResultados;&lt;br/&gt;            RAISE;&lt;br/&gt;END;</source>
<body>CREATE OR REPLACE PROCEDURE CONSULTOR3.INS_PRESUP (&lt;br/&gt;  &quot;VAR_NOMBRE&quot; IN VARCHAR2, &lt;br/&gt;  &quot;VAR_ID_SEDE&quot; IN NUMBER, &lt;br/&gt;  &quot;VAR_USUARIO_REG&quot; IN VARCHAR2, &lt;br/&gt;  &quot;VAR_DESDE&quot; IN DATE, &lt;br/&gt;  &quot;VAR_HASTA&quot; IN DATE,&lt;br/&gt;  &quot;CUR_RPTA&quot; OUT SYS_REFCURSOR ) IS&lt;br/&gt;BEGIN&lt;br/&gt;&lt;br/&gt;    SAVEPOINT obtenerResultados;&lt;br/&gt;&lt;br/&gt;	INSERT INTO T_PRESUP (NOMB_PRESUP,ID_SEDE,FECHA_REG,USUARIO_REG,ULT_MODIF_FEC, ULT_MODIF_USER, FECHA_VAL_INI, FECHA_VAL_FIN,EST_ACTUAL)&lt;br/&gt;	VALUES&lt;br/&gt;	(VAR_NOMBRE,VAR_ID_SEDE,SYSDATE,VAR_USUARIO_REG,SYSDATE,VAR_USUARIO_REG,VAR_DESDE,VAR_HASTA,5);&lt;br/&gt;&lt;br/&gt;	OPEN CUR_RPTA FOR&lt;br/&gt;	SELECT&lt;br/&gt;        A.ID_PRESUPUESTO,&lt;br/&gt;        A.NOMB_PRESUP,&lt;br/&gt;        A.ID_SEDE,&lt;br/&gt;		B.NOMB_SEDE,&lt;br/&gt;        A.FECHA_REG,&lt;br/&gt;        A.USUARIO_REG,&lt;br/&gt;        A.ULT_MODIF_FEC,&lt;br/&gt;        A.ULT_MODIF_USER,&lt;br/&gt;        A.FECHA_VAL_INI,&lt;br/&gt;        A.FECHA_VAL_FIN,&lt;br/&gt;        A.EST_ACTUAL&lt;br/&gt;	FROM&lt;br/&gt;		T_PRESUP A &lt;br/&gt;		INNER JOIN T_SEDE B ON A.ID_SEDE=B.ID_SEDE&lt;br/&gt;	WHERE&lt;br/&gt;		A.FECHA_REG=(SELECT MAX(FECHA_REG) FROM T_PRESUP);&lt;br/&gt;&lt;br/&gt;EXCEPTION &lt;br/&gt;        WHEN OTHERS THEN&lt;br/&gt;&lt;br/&gt;            ROLLBACK TO obtenerResultados;&lt;br/&gt;            RAISE;&lt;br/&gt;END;</body>
</StoredProcedureOraclev10g>